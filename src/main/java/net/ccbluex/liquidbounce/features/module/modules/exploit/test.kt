package net.ccbluex.liquidbounce.features.module.modules.world

import net.ccbluex.liquidbounce.event.EventTarget
import net.ccbluex.liquidbounce.event.PacketEvent
import net.ccbluex.liquidbounce.features.module.Category
import net.ccbluex.liquidbounce.features.module.Module
import net.ccbluex.liquidbounce.utils.PacketUtils
import net.minecraft.network.play.client.C0BPacketEntityAction
import net.minecraft.network.play.client.C0CPacketInput
import net.minecraft.network.play.server.S12PacketEntityVelocity

object HitResponse : Module("HitResponse", Category.WORLD) {

    @EventTarget
    fun onPacket(event: PacketEvent) {
        if (event.packet is S12PacketEntityVelocity) {
            val packet = event.packet as S12PacketEntityVelocity

            if (packet.entityID == mc.thePlayer.entityId) {
                val moveForwardPacket = C0CPacketInput(1.0f, 0.0f, false, false)
                PacketUtils.sendPacketNoEvent(moveForwardPacket)

                val stopSprintPacket = C0BPacketEntityAction(mc.thePlayer, C0BPacketEntityAction.Action.STOP_SPRINTING)
                PacketUtils.sendPacketNoEvent(stopSprintPacket)
                
                val startSprintPacket = C0BPacketEntityAction(mc.thePlayer, C0BPacketEntityAction.Action.START_SPRINTING)
                PacketUtils.sendPacketNoEvent(startSprintPacket)
            }
        }
    }
}
